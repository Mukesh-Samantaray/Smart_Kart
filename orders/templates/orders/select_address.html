{% extends "accounts/home.html" %}
{% load static %}

{% block content %}
<div class="container mt-4">
    <h3>Select Shipping Address & Place Order</h3>

    {% if addresses %}
        <form method="POST">
            {% csrf_token %}
            <div class="list-group mb-3">
                {% for address in addresses %}
                    <label class="list-group-item">
                        <input type="radio" name="address_id" value="{{ address.id }}" {% if forloop.first %}checked{% endif %}>
                        <strong>{{ address.name }}</strong>, {{ address.street }}, {{ address.city }}, {{ address.state }} - {{ address.pincode }}
                    </label>
                {% endfor %}
            </div>
            <button type="submit" class="btn btn-success">Place Order</button>
        </form>
    {% else %}
        <p>No addresses found. <a href="{% url 'profile:add_address' %}">Add New Address</a></p>
    {% endif %}

    <hr>
    <h4>Cart Summary</h4>
    {% if cart_items %}
        <ul class="list-group">
            {% for item in cart_items %}
                <li class="list-group-item">
                    {{ item.product.name }} - {{ item.quantity }} x ₹{{ item.product.price }} = ₹{{ item.total_price }}
                </li>
            {% endfor %}
        </ul>
        <p class="mt-2"><strong>Total: ₹{{ cart_items|sum:'total_price' }}</strong></p>
    {% else %}
        <p>Your cart is empty.</p>
    {% endif %}
</div>
{% endblock %}
